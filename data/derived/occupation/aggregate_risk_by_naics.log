
  ___  ____  ____  ____  ____ (R)
 /__    /   ____/   /   ____/
___/   /   /___/   /   /___/   16.1   Copyright 1985-2019 StataCorp LLC
  Statistics/Data Analysis            StataCorp
                                      4905 Lakeway Drive
     MP - Parallel Edition            College Station, Texas 77845 USA
                                      800-STATA-PC        http://www.stata.com
                                      979-696-4600        stata@stata.com
                                      979-696-4601 (fax)

Single-user 2-core Stata perpetual license:
       Serial number:  501606204617
         Licensed to:  Miklos Koren
                       CEU MicroData

Notes:
      1.  Stata is running in batch mode.
      2.  Unicode is supported; see help unicode_advice.
      3.  More than 2 billion observations are allowed; see help obs_advice.
      4.  Maximum number of variables is set to 5000; see help set_maxvar.

. do aggregate_risk_by_naics.do 

. clear all

. use "../../clean/employment-matrix/matrix.dta"

. 
. local indexes teamwork customer presence teamwork_interact customer_interact 
> presence_interact f2f_email f2f prox

. 
. merge m:1 SOCCode using "risks.dta", keep(master match) nogen

    Result                           # of obs.
    -----------------------------------------
    not matched                            71
        from master                        71  
        from using                          0  

    matched                            13,936  
    -----------------------------------------

. * a few cases are missing the risk, take these to be low risk
. mvencode `indexes', mv(0) override
    teamwork: 607 missing values recoded
    customer: 607 missing values recoded
    presence: 607 missing values recoded
teamwork_i~t: 607 missing values recoded
customer_i~t: 607 missing values recoded
presence_i~t: 607 missing values recoded
   f2f_email: 607 missing values recoded
         f2f: 607 missing values recoded
        prox: 607 missing values recoded

. 
. replace Employment = round(Employment*1000)
(14,007 real changes made)

. compress
  variable Employment was double now long
  variable count was double now int
  (140,070 bytes saved)

. 
. * both or all three
. generate byte communication = teamwork | customer

. generate byte affected = communication | presence

. * share of workers communicating but not remotely
. *generate byte face2face = communication & !remote
. * both or all three
. 
. generate byte communication_interact = teamwork_interact|customer_interact

. generate byte affected_interact = communication_interact|presence_interact

. 
. 
. foreach X of var `indexes'  communication affected  communication_interact af
> fected_interact ///
> can_wh ever_wh full_day_wh wh_5days wh_3days wh_1days wh_2weeks wh_1month  {
  2.         generate double `X'_share = `X' * Employment
  3. }
(1,046 missing values generated)
(1,046 missing values generated)
(1,046 missing values generated)
(1,046 missing values generated)
(1,046 missing values generated)
(1,046 missing values generated)
(1,046 missing values generated)
(1,046 missing values generated)

. 
. collapse (sum) Employment teamwork_share customer_share presence_share ///
> communication_share affected_share  communication_interact_share affected_int
> eract_share ///
> teamwork_interact_share customer_interact_share presence_interact_share ///
> can_wh_share ever_wh_share full_day_wh_share wh_5days_share wh_3days_share //
> /
> wh_1days_share wh_2weeks_share wh_1month_share f2f_email_share f2f_share prox
> _share, by(industry_code)

. 
. 
. foreach X in `indexes'  communication affected  communication_interact affect
> ed_interact ///
> can_wh ever_wh full_day_wh wh_5days wh_3days wh_1days wh_2weeks wh_1month  {
  2.         replace `X'_share = round(`X'_share / Employment * 100)
  3. }
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)
(84 real changes made)

. drop Employment

. 
. 
. label variable teamwork_interact_share "Teamwork communication (dummy) with c
> ontext cutoff - interaction"

. label variable customer_interact_share "Customer communication (dummy) with c
> ontext cutoff - interaction"

. label variable presence_interact_share "Physical presence (dummy) with contex
> t cutoff - interaction"

. label variable customer_interact_share "Customer communication (dummy) versio
> n 2 with context cutoff - interaction"

. 
. label variable teamwork_share "Teamwork communication (dummy)"

. label variable customer_share "Customer communication (dummy)"

. label variable presence_share "Physical presence (dummy)"

. label variable customer_share "Customer communication (dummy)"

. 
. 
. label var can_wh "as part of the (main) job, can you work at home?"

. label var ever_wh "Do you ever work at home?"

. label var full_day_wh "Are there days when you work only at home?"

. label var wh_5days "work home 5 or more days a week"

. label var wh_3days "work home 3 or more days a week"

. label var wh_1days "work home 1 or more days a week"

. label var wh_2weeks "work home at least once in every 2 weeks or more"

. label var wh_1month "work home at least once a month or more"

. 
. label var f2f_email_share "((face2face > 75)&(face2face > email)&(face2face >
>  memo))"

. label var f2f_share "(face2face > 75)"

. label var prox_share "(proximity > 25)"

. 
. export delimited "naics_risk.csv", replace
(note: file naics_risk.csv not found)
file naics_risk.csv saved

. 
end of do-file
